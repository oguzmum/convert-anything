<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Converter UI</title>
    <link rel="stylesheet" href="/static/styles.css" />
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
  </head>
  <body>
    <main class="page">
      <header class="hero">
        <p class="eyebrow">Convert Anything</p>
        <h1>Format Converter</h1>
        <p class="subtitle">
          Upload a file, choose the desired output format and download the result.
        </p>
      </header>

      <section class="card">
        <div class="field">
          <label for="mode">Mode</label>
          <select id="mode" name="mode">
            <option value="conversion">Conversion</option>
            <option value="compression">Compression</option>
          </select>
        </div>

        <form
          id="conversion-form"
          class="stack mode-panel"
          hx-post="/convert"
          hx-target="#result"
          hx-swap="innerHTML"
          enctype="multipart/form-data"
        >
          <div class="field">
            <label for="convert-file">Select file</label>
            <input id="convert-file" name="file" type="file" accept=".heic,.heif,.png,.jpg,.jpeg,.pdf,image/heic,image/heif,image/png,image/jpeg,application/pdf" />
            <p class="hint">Possible options: HEIC/HEIF/PNG/JPG/PDF → PNG, JPG or PDF</p>
          </div>

          <div class="field">
            <label for="output">Output format</label>
            <select id="output" name="output">
              <option value="png">PNG</option>
			  <option value="jpg">JPG/JPEG</option>
              <option value="pdf">PDF</option>
            </select>
          </div>

          <div class="button-row">
            <button type="submit" class="primary">Convert</button>
          </div>
        </form>

        <form
          id="compression-form"
          class="stack mode-panel is-hidden"
          hx-post="/compress"
          hx-target="#result"
          hx-swap="innerHTML"
          enctype="multipart/form-data"
        >
          <div class="field">
            <label for="compress-file">Select image</label>
            <input id="compress-file" name="file" type="file" accept=".heic,.heif,.png,.jpg,.jpeg,image/heic,image/heif,image/png,image/jpeg" />
            <p class="hint">Possible options: HEIC/HEIF/PNG/JPG → compressed image</p>
          </div>

          <div class="field">
            <label for="quality">JPG quality (for HEIC/JPG)</label>
            <input id="quality" name="quality" type="range" min="20" max="95" step="1" value="75" oninput="this.nextElementSibling.value = this.value" />
            <output>75</output>
            <p class="hint">PNG uses palette reduction + optimization. HEIC/JPG are compressed to JPG.</p>
          </div>

          <div class="button-row">
            <button type="submit" class="primary">Compress</button>
          </div>
        </form>

        <div id="result" class="result">
          <p>No conversion started yet.</p>
        </div>
      </section>
    </main>

    <script>
      const modeSelect = document.getElementById("mode");
      const conversionForm = document.getElementById("conversion-form");
      const compressionForm = document.getElementById("compression-form");

      function syncMode() {
        const mode = modeSelect.value;
        conversionForm.classList.toggle("is-hidden", mode !== "conversion");
        compressionForm.classList.toggle("is-hidden", mode !== "compression");
      }

      modeSelect.addEventListener("change", syncMode);
      syncMode();
    </script>
  </body>
</html>
